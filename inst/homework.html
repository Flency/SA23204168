<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Heng Liu" />

<meta name="date" content="2023-11-27" />

<title>homework answers</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">homework answers</h1>
<h4 class="author">Heng Liu</h4>
<h4 class="date">2023-11-27</h4>



<div id="homework-1" class="section level2">
<h2>homework 1</h2>
<div id="question-3.2" class="section level3">
<h3>question 3.2</h3>
<p>The standard Laplace distribution has density <span class="math inline">\(f(x)=\frac12e^{-|x|},x\in\mathbb{R}\)</span>. Use the inverse transform method to generate a random sample of size 1000 from this distribution.</p>
<p>因为Laplace分布的PDF在<span class="math inline">\(x=0\)</span>处发生跳跃，所以需要分开积分。对于<span class="math inline">\(x&lt;0\)</span>的部分,<span class="math inline">\(F(x)=\int_{-\infty}^x\frac{1}{2}\exp(x) dx=\frac{1}{2}\exp(x)\)</span>,对于<span class="math inline">\(x\geq 0\)</span>的部分,<span class="math inline">\(F(x)=\int_{-\infty}^0\frac{1}{2}\exp(x)dx+\int_{0}^x\frac{1}{2}\exp(-x) dx=1-\frac{1}{2}\exp(-x)\)</span>。</p>
<p>生成一个随机变量<span class="math inline">\(U\sim U(0,1)\)</span>,如果<span class="math inline">\(u&lt;\frac{1}{2}\)</span>,那么<span class="math inline">\(u=\frac{1}{2}\exp(x)\)</span>，如果<span class="math inline">\(u\geq \frac{1}{2}\)</span>,那么,<span class="math inline">\(u=1-\frac{1}{2}\exp(-x)\)</span>,因此，逆分布为<span class="math inline">\(\left.x=F^{-1}(u)=\left\{\begin{array}{ll}-\log(2-2u),&amp;\frac{1}{2}\leq u&lt;1\\\log(2u),&amp;0&lt;u&lt;\frac{1}{2}.\end{array}\right.\right.\)</span>。</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">which</span>(u <span class="sc">&gt;=</span> <span class="fl">0.5</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2-2</span> <span class="sc">*</span> u[index]), <span class="fu">log</span>(<span class="dv">2</span> <span class="sc">*</span> u[<span class="sc">-</span>index]))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>x_neg<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">0</span>,<span class="fl">0.1</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>x_pos<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">freq =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x_neg, <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">exp</span>(x_neg))</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x_pos, <span class="fl">0.5</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x_pos))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3.7" class="section level3">
<h3>question 3.7</h3>
<p>Write a function to generate a random sample of size n from the Beta(a, b) distribution by the acceptance-rejection method. Generate a random sample of size 1000 from the Beta(3,2) distribution. Graph the histogram of the sample with the theoretical Beta(3,2) density superimposed.</p>
<p>取<span class="math inline">\(g(x)=1\)</span>,那么有<span class="math inline">\(\frac{f(x)}{g(x)}=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}\frac{x^{a-1}(1-x)^{b-1}}1\leq\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)},\quad0&lt;x&lt;1\)</span>。记<span class="math inline">\(c=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}\)</span>于是，有<span class="math inline">\(\frac{f(x)}{cg(x)}\leq 1\)</span>。生成一个随机变量<span class="math inline">\(U\sim U(0,1)\)</span>，如果<span class="math inline">\(u\leq x^{a-1}(1-x)^{b-1}\)</span>，则接受<span class="math inline">\(x\)</span>，否则就拒绝。</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>rbeta <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (x<span class="sc">^</span>(a <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> x)<span class="sc">^</span>(b <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">&gt;</span> u) {</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>      y[k] <span class="ot">&lt;-</span> x</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(y)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>} </span></code></pre></div>
<p>生成大小为1000，服从<span class="math inline">\(B(3,2)\)</span>分布的随机样本。</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>beta_sample<span class="ot">&lt;-</span><span class="fu">rbeta</span>(<span class="dv">1000</span>,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(beta_sample,<span class="at">freq =</span> F)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>fy <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="sc">*</span> y<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> y)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y, fy)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3.9" class="section level3">
<h3>question 3.9</h3>
<p>The rescaled Epanechnikov kernel [85] is a symmetric density function <span class="math inline">\(f_e(x)=\frac34(1-x^2),\quad|x|\leq1.\)</span> Devroye and Gy¨orfi [71, p. 236] give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U1, U2, U3 \sim Uniform(−1, 1)\)</span>. If <span class="math inline">\(|U3|\geq |U2|\)</span> and <span class="math inline">\(|U3|\geq |U1|\)</span>, deliver U2; otherwise deliver U3. Write a function to generate random variates from <span class="math inline">\(f_e\)</span>, and construct the histogram density estimate of a large simulated random sample.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>data_gen<span class="ot">&lt;-</span><span class="cf">function</span>(n){</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,n)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  u1<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  u2<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  u3<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  u2index<span class="ot">&lt;-</span><span class="fu">which</span>(<span class="fu">abs</span>(u3)<span class="sc">&gt;=</span><span class="fu">abs</span>(u2)<span class="sc">&amp;</span><span class="fu">abs</span>(u3)<span class="sc">&gt;=</span><span class="fu">abs</span>(u1))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  u3index<span class="ot">&lt;-</span><span class="fu">setdiff</span>(<span class="dv">1</span><span class="sc">:</span>n,u2index)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  x[u3index]<span class="ot">&lt;-</span>u3[u3index]</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  x[u2index]<span class="ot">&lt;-</span>u2[u2index]</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">data_gen</span>(<span class="dv">10000</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">freq =</span> F)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.001</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>fe <span class="ot">&lt;-</span> <span class="fl">0.75</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(a, fe)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="reproduce-sample-function-using-inverse-transformation-method" class="section level3">
<h3>reproduce sample function using inverse transformation method</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>mysample<span class="ot">&lt;-</span><span class="cf">function</span>(data,sample_size,prob){</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 放回</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 使用逆变换法生成有放回抽样的索引</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  sampled_indices <span class="ot">&lt;-</span> <span class="fu">integer</span>(sample_size)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 生成[0, 1)之间的均匀随机数</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(sample_size)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 计算累积概率</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  cumulative_prob <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(prob)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 找到所在区间</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  index <span class="ot">&lt;-</span> <span class="fu">findInterval</span>(U,cumulative_prob)<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 根据索引获取抽样的数据</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  sampled_data <span class="ot">&lt;-</span> data[index]</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(sampled_data)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 测试</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 准备数据集</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;E&quot;</span>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 指定每个元素的抽样概率</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>probabilities <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 放回</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 指定抽样大小</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a><span class="fu">mysample</span>(<span class="at">data=</span>data,<span class="at">sample_size =</span> sample_size,<span class="at">prob =</span> probabilities)</span></code></pre></div>
<pre><code>## [1] &quot;E&quot; &quot;D&quot; &quot;E&quot;</code></pre>
</div>
</div>
<div id="homework-2" class="section level2">
<h2>homework 2</h2>
<div id="question-1.2" class="section level3">
<h3>Question 1.2</h3>
<p>Take three different values of <span class="math inline">\(\rho\)</span> (0 ≤ <span class="math inline">\(\rho\)</span> ≤ 1, including <span class="math inline">\(\rho_{min}\)</span>) and use Monte Carlo simulation to verify your answer. (n = <span class="math inline">\(10^6\)</span>, Number of repeated simulations K = 100)</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the variance of the estimator</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>pihat.var <span class="ot">&lt;-</span> <span class="cf">function</span>(rho){</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  l <span class="ot">&lt;-</span> d<span class="sc">*</span>rho</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  M<span class="ot">=</span><span class="dv">100</span> <span class="co">#repeat 100 times</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  pihat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M) {</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,d<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    pihat[i] <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>l<span class="sc">/</span>d<span class="sc">/</span><span class="fu">mean</span>(l<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var</span>(pihat)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Select <span class="math inline">\(\rho=0.5\)</span>,<span class="math inline">\(\rho=0.8\)</span>, and <span class="math inline">\(\rho=1\)</span>to verify</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rho=0.5</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pihat.var</span>(<span class="fl">0.5</span>)</span></code></pre></div>
<pre><code>## [1] 2.311341e-05</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rho=0.8</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pihat.var</span>(<span class="fl">0.8</span>)</span></code></pre></div>
<pre><code>## [1] 8.618427e-06</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rho=1</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pihat.var</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## [1] 5.477658e-06</code></pre>
<p>We can find that the variance of the estimator decreases as <span class="math inline">\(\rho\)</span> increases, and the variance is minimum when <span class="math inline">\(\rho=1\)</span>.</p>
</div>
<div id="ex-5.7" class="section level3">
<h3>Ex 5.7</h3>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>simple_mc<span class="ot">&lt;-</span><span class="cf">function</span>(){</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  m<span class="ot">&lt;-</span><span class="fl">1e5</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  times<span class="ot">&lt;-</span><span class="fl">1e3</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  simple_mc<span class="ot">&lt;-</span><span class="fu">numeric</span>(times)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>times) {</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    U<span class="ot">&lt;-</span><span class="fu">runif</span>(m)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    simple_mc[i]<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">exp</span>(U))</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  simple_mc</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>anti_variate<span class="ot">&lt;-</span><span class="cf">function</span>(){</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  m<span class="ot">&lt;-</span><span class="fl">1e5</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  times<span class="ot">&lt;-</span><span class="fl">1e3</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>  anti_variate<span class="ot">&lt;-</span><span class="fu">numeric</span>(times)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>times) {</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    U<span class="ot">&lt;-</span><span class="fu">runif</span>(m<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    anti_variate[i]<span class="ot">&lt;-</span><span class="fu">mean</span>((<span class="fu">exp</span>(U)<span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>U))<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  anti_variate</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>simple_mc_result<span class="ot">&lt;-</span><span class="fu">simple_mc</span>()</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>anti_variate_result<span class="ot">&lt;-</span><span class="fu">anti_variate</span>()</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimates from both methods</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(simple_mc_result), <span class="fu">mean</span>(anti_variate_result))</span></code></pre></div>
<pre><code>## [1] 1.718266 1.718260</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variance of the two methods</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">var</span>(simple_mc_result), <span class="fu">var</span>(anti_variate_result))</span></code></pre></div>
<pre><code>## [1] 2.636888e-06 7.872039e-08</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportion of variance reduction</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>(<span class="fu">var</span>(simple_mc_result) <span class="sc">-</span> <span class="fu">var</span>(anti_variate_result))<span class="sc">/</span><span class="fu">var</span>(simple_mc_result)</span></code></pre></div>
<pre><code>## [1] 0.9701465</code></pre>
<p>It can be found that the percent reduction in variance calculated by the simulation is almost the same as the theoretical value.</p>
</div>
</div>
<div id="homework-3" class="section level2">
<h2>homework 3</h2>
<div id="section" class="section level3">
<h3>5.13</h3>
<p>观察g(x)的函数图，选取如下重要函数： <span class="math inline">\(f_1=2 f(x-1),x&gt;1\)</span>,其中<span class="math inline">\(f(x) \sim t(1)\)</span>.</p>
<p><span class="math inline">\(f_2=2\phi(x-1),x&gt;1\)</span>,其中<span class="math inline">\(\phi(x) \sim N(0,1)\)</span></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>, <span class="fl">0.01</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="dv">2</span><span class="sc">*</span><span class="fu">dt</span>(x<span class="dv">-1</span>,<span class="at">df =</span> <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="dv">2</span><span class="sc">*</span><span class="fu">dnorm</span>(x,<span class="at">mean=</span><span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;g(x)&quot;</span>, <span class="st">&quot;f1&quot;</span>,<span class="st">&quot;f2&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAWlBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmZmZmtv+QOgCQZgCQkGaQ2/+2ZgC2tma2/7a2///bkDrb/9vb////tmb/25D//7b//9v///+jsVLVAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIFElEQVR4nO2di3abOBRFSSbOTN3WnbgtHWL7/39zEAIDNtJB72t89lppvFx8BRuhd+TqQqxUpU9AOhQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCBBZUPUwlBIkOJpfaArKew4UZIji/GivCxs1ml9o5qC850BBWcNRUNZofqEpKO85UFDWcBSUNZpfaArKew7PLuhYVbvzoe1RfI8SDhEl2vkwnOzp64d7aKdzqN/+ax3t2qT2XyKEg0SJVu+uL5v2/F1Du5zD+dBqaV7UbajHpLzDYWJEO+3H3D5mpjSCurSa19+X4d+wcJiQaG1p8PJvezPVmdbtT5fpx/u6yRzkMoZ6bJ00VXuux50+8e6M9ck7nahfGdSpCg4H8Y/2+a4epuPLhy4tm9dfXQGt33YKvdFarC8IlKDuVLvbOq1cnr0dVA+C+jzT6FtKQQM3Oeh8+Na9kU9QLbwW0xmnHsqg+u1PV2omL4OMUeZ1Sayx+4Aws1pMZaMuT6WuxRzCRYkb2A56/akstT/HtvY9H3bJ20FO4WIEDo3RdA3EscadvE4kqKviWwwlkLAyqC9/8vXFLnXVVwJNtaKhGC4rIEJTDa21jL35Sft5TVejqKBooZ07qxr5ndVYoRPmoPDa/tEEtWVQn4VWlUHhPJyg9iHTtZgh/9wPUDhFR9FcqKvuHn7+Y6hvy7eDYkT3/3jf6TrtTQ0SIYKKRdP1SWNusUkRFBbe+9Of70pNW1KaattnF3RtkYgXFDXaMFxg+j3hcQQFtYWYg5JFEy4o1mrXzQqaPlkhrjYsqHS0RxAUYfR1O4KWJoCLCooXOmEOer4BM8dw4Vlo44LC03gWQUKi+YVOKehaCvkmsnVBl00JOu2rne1An3QLDtqrIddumjN08HxyYG0OtxrDkKvnlYYNuZ4PLx/tRS3fds9HLNiRId0Cgr4PS2CW29LeZVBtm3nvGVfZ+Ke7isAh1+7luOLFL/TswKabzz4fDLM6w6SPZfmCacjV71LD+2J6oVBI6PFAdfnajLGH188XOuSgoaaPIkgFs/1MuAoyTXH61GLLefEmXaXQ5RELeuYi9OZNVXOydtCx1egjyOtagwUZp8gTNhTr6otPIV1EUG2ukhO2pD/f/xJfi2lBtXG9e9quRttAdRAUUkyHtoMsTToZfbHpW/kF1bpBErMdtB6HheQBI4uiOqthya3Y/cUjpe0IWhOOgozhnmjI1W8huXcx/XCC3BaSj29W7kl5fiJ+aJdzcF0G7JVIjM/FDO1yDqELyZ2v99EEeecgj7T8PpAgtGMZ5LmQ3LOx+HCCnBeS37zvesGPJ8g7nM5CFDQLF77vpH2rhTB8rigCY7iqX6E7/++EecKN4oKuw0Dji7gpBVJaUDXNSklSCqSwoGpeFk1+SdFUWtD8zerugOKUFXQbVIqVCaXLoMW3db0WN0FfpAkaDVHQ8vu+Q0KpEDdoH+ePN+IhLQctNwAKIlDQaEiCI3mCJi1qCjL8nwQxAxIFLXXUiiFS0H1fvxxCBRX3ckWmoMlfbwSPNgYiVNB8nKikokSCwjd5u/kLoGKOUs2Lec3Nz4+YDRkVy0ZJBIXOrPaHiMhDSQRF2uTtbpDaaRomEoJz0F0euns7B6nKoDibvFWG4aGMQ46JajHvufm748yjH9XilGNspLaDJkei+bLBU5rySb6gq6JV49RVNfcVbC21oDg7kg+jtJXHE2XdrOv2d8CJ5hqTXvPZTLhdd8FHrCgUBBDbWZWC3M6qEIp1NR6GFIJWdFYDklnRGMqUjvfhK3JQQDIbELSisxqQzBYE4c5qQDKbEOQNBYUnQ0HBh1BQjiAUFOGQgMOfDwoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFATIIMi2MfiEo30cV+2ADLZMV/sCmreWvFy/ErIx7R24RHpB1o3BRxr7QLf6mubT3hqkbtNpbIb6r4RUO0wbdpleIL0g68bgV057qyA942QN0n1fevf18gb6r4TUoSzHzclVBqFbVr/9sAn6/BvecSRo+ErIdTfsSi5Bho3BB1oB1jKoef21RwUZfMT0fLB2vXpqOJMgMNOosr1VUK2eDp1HbImAwrezovPy6kIojyDjxuA9aibbLugF33aVSa07AMsVhGaqu1xvF9Spsez0vapskfqIWTYGHw7QmC9fX4+1qF6RM4QW0raNwSdYc1D/3c22q9IXbj2kEVnN24uFEXtLWpVSk+U3iwHWlUHiGorWjcEngK5Gg/srR3RIn71qWV2NB4eCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCCBdkFoJdto77jUTE+mC1KIp182KoiJdkFoh/XX1aqcEiBd0OcI/80iKfEH2xfPJES/ofPjmuKFcXMQLqt/+2Be3Jka6ILVA2nVPwqhIF3Ts1kcXLKalCyoOBQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQE+B9yzN3MLZED8wAAAABJRU5ErkJggg==" /><!-- --></p>
<p>比较<span class="math inline">\(g(x)/f(x)\)</span>的值</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">dt</span>(x<span class="dv">-1</span>,<span class="at">df =</span> <span class="dv">1</span>)), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>,<span class="at">ylab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">dnorm</span>(x, <span class="at">mean=</span><span class="dv">1</span>)), <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;f1&quot;</span>, <span class="st">&quot;f2&quot;</span>),<span class="at">lty =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> 从图中，我们可以得知使用<span class="math inline">\(f_2\)</span>作为重要性函数在估计积分时产生较小的方差，因为比值<span class="math inline">\(g(x)/f_2(x)\)</span>更接近于常数。</p>
</div>
<div id="section-1" class="section level3">
<h3>5.14</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>Importance_sampling1 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="at">expr =</span> {</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">rt</span>(m,<span class="at">df=</span><span class="dv">1</span>))<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">dt</span>(x<span class="dv">-1</span>,<span class="at">df=</span><span class="dv">1</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(g<span class="sc">/</span>f)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>Importance_sampling2 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="at">expr =</span> {</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">rnorm</span>(m)) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">dnorm</span>(x, <span class="at">mean=</span><span class="dv">1</span>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(g<span class="sc">/</span>f)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(Importance_sampling1), <span class="fu">mean</span>(Importance_sampling2))</span></code></pre></div>
<pre><code>## [1] 0.4007031 0.4005945</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">var</span>(Importance_sampling1), <span class="fu">var</span>(Importance_sampling2))</span></code></pre></div>
<pre><code>## [1] 5.665737e-06 1.933241e-07</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(Importance_sampling2)<span class="sc">/</span><span class="fu">var</span>(Importance_sampling1)</span></code></pre></div>
<pre><code>## [1] 0.03412161</code></pre>
<p>可以看到，在使用<span class="math inline">\(f_2\)</span>作为重要函数时产生的方差更小。</p>
</div>
<div id="section-2" class="section level3">
<h3>5.15</h3>
<p>分层重要抽样估计</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co">#层数</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> M<span class="sc">/</span>k <span class="co">#每层样本</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) (k<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m, (j <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>k, j<span class="sc">/</span>k)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">*</span> u)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f</span>(x)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>theta.hat[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>se[j] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(theta.hat)</span></code></pre></div>
<pre><code>## [1] 0.5247439</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(se)</span></code></pre></div>
<pre><code>## [1] 0.003648978</code></pre>
<p>重要抽样(不使用分层抽样)</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> M<span class="sc">/</span>k</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m, (j <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>k, j<span class="sc">/</span>k)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)) <span class="sc">*</span> u)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f</span>(x)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>theta.hat[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>se[j] <span class="ot">&lt;-</span> <span class="fu">sd</span>(fg)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(theta.hat)</span></code></pre></div>
<pre><code>## [1] 0.5264051</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(se)</span></code></pre></div>
<pre><code>## [1] 0.09626178</code></pre>
<p>可以看到分层重要抽样大大缩减了方差。</p>
</div>
<div id="section-3" class="section level3">
<h3>6.5</h3>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>t0 <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">10000</span>, <span class="at">expr =</span> {</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">mean</span>(x) <span class="sc">+</span> t0 <span class="sc">*</span> <span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>LCL <span class="ot">&lt;-</span> CI[<span class="dv">1</span>, ]</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>UCL <span class="ot">&lt;-</span> CI[<span class="dv">2</span>, ]</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(LCL <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">&amp;</span> UCL <span class="sc">&gt;</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.923</code></pre>
<p>可以看到，t区间比方差区间(example 6.4: 77.3%覆盖率)更稳健</p>
</div>
<div id="a" class="section level3">
<h3>6.A</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>num_simulations <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>population_mean <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 初始化</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>rejection_count <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">3</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Monte Carlo模拟</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_simulations) {</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (i) χ²(1)分布</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  sample_data_chisq <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">30</span>, <span class="at">df =</span> <span class="dv">1</span>)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (ii) Uniform(0,2)分布</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  sample_data_unif <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">30</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">2</span>)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (iii) 指数分布</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  sample_data_exp <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">30</span>, <span class="at">rate =</span> <span class="dv">1</span>)</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># t检验</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>  t_test_result_chisq <span class="ot">&lt;-</span> <span class="fu">t.test</span>(sample_data_chisq, <span class="at">mu =</span> population_mean, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  t_test_result_unif <span class="ot">&lt;-</span> <span class="fu">t.test</span>(sample_data_unif, <span class="at">mu =</span> population_mean, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  t_test_result_exp <span class="ot">&lt;-</span> <span class="fu">t.test</span>(sample_data_exp, <span class="at">mu =</span> population_mean, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 判断是否拒绝零假设</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (t_test_result_chisq<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha) {</span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>    rejection_count[<span class="dv">1</span>] <span class="ot">&lt;-</span> rejection_count[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (t_test_result_unif<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha) {</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>    rejection_count[<span class="dv">2</span>] <span class="ot">&lt;-</span> rejection_count[<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (t_test_result_exp<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha) {</span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>    rejection_count[<span class="dv">3</span>] <span class="ot">&lt;-</span> rejection_count[<span class="dv">3</span>] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算经验I型错误率</span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>empirical_type_1_error_rate <span class="ot">&lt;-</span> rejection_count <span class="sc">/</span> num_simulations</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Empirical Type I Error Rate:&quot;</span>, empirical_type_1_error_rate, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Empirical Type I Error Rate: 0.0904 0.0495 0.0687</code></pre>
</div>
</div>
<div id="homework-4" class="section level2">
<h2>homework 4</h2>
<div id="question1" class="section level3">
<h3>question1</h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置模拟参数</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">1</span> <span class="co"># 显著性水平</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 模拟一千次</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>rep<span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>,{</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  H0 <span class="ot">&lt;-</span> <span class="fu">runif</span>(.<span class="dv">95</span><span class="sc">*</span>m,<span class="dv">0</span>,<span class="dv">1</span>)<span class="co"># H0假设的p值，占总数的95%</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  H1 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(.<span class="dv">05</span><span class="sc">*</span>m,.<span class="dv">1</span>,<span class="dv">1</span>)<span class="co"># H1假设的p值，占总数的5%</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">c</span>(H0,H1)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  p.adj1 <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p,<span class="at">method=</span><span class="st">&#39;BH&#39;</span>)<span class="co"># Benjamini-Hochberg 校正</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  p.adj2 <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p,<span class="at">method=</span><span class="st">&#39;bonferroni&#39;</span>)<span class="co"># Bonferroni 校正</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  FWER <span class="ot">&lt;-</span> FDR <span class="ot">&lt;-</span> TPR <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  FDR[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.adj1[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span>alpha)<span class="sc">/</span><span class="fu">sum</span>(p.adj1<span class="sc">&lt;</span>alpha)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  FDR[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.adj2[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span>alpha)<span class="sc">/</span><span class="fu">sum</span>(p.adj2<span class="sc">&lt;</span>alpha)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  FWER[<span class="dv">1</span>] <span class="ot">&lt;-</span> (<span class="fu">sum</span>(p.adj1[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span>alpha)<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  FWER[<span class="dv">2</span>] <span class="ot">&lt;-</span> (<span class="fu">sum</span>(p.adj2[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span>alpha)<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  TPR[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.adj1[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>)]<span class="sc">&lt;</span>alpha)<span class="sc">/</span><span class="dv">50</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>  TPR[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.adj2[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>)]<span class="sc">&lt;</span>alpha)<span class="sc">/</span><span class="dv">50</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(FWER,FDR,TPR)</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">apply</span>(rep,<span class="dv">1</span>,<span class="at">FUN=</span>mean)</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">round</span>(result,<span class="dv">3</span>),<span class="at">ncol=</span><span class="dv">3</span>,<span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(A)<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>,<span class="st">&quot;FDR&quot;</span>,<span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(A)<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;B-H&quot;</span>,<span class="st">&quot;Bonferroni&quot;</span>)</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(A)</span></code></pre></div>
<pre><code>##             FWER FDR   TPR
## B-H        0.040 NaN 0.001
## Bonferroni 0.036 NaN 0.001</code></pre>
</div>
<div id="question2" class="section level3">
<h3>question2</h3>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>true_lambda <span class="ot">&lt;-</span> <span class="dv">2</span>          <span class="co"># 真实参数 lambda</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>)  <span class="co"># 样本大小</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span>                 <span class="co"># Bootstrap重抽样次数</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span>                 <span class="co"># 用于Bootstrap的样本数量</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建空数组以存储结果</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>mean_bias_results <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(sample_sizes))      <span class="co"># 均值偏差结果</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>standard_error_results <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(sample_sizes))  <span class="co"># 标准误差结果</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 模拟循环</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sample_sizes)) {</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> sample_sizes[i]   <span class="co"># 当前样本大小</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  biases <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)   <span class="co"># 存储每次模拟的均值偏差</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  standard_errors <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)  <span class="co"># 存储每次模拟的标准误差</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 从指数分布生成一个随机样本</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="at">rate =</span> <span class="dv">1</span><span class="sc">/</span>true_lambda)</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>    sample_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(data)</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 计算 lambda 的极大似然估计</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>    lambda_hat <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> sample_mean</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Bootstrap重抽样</span></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>    bootstrap_estimates <span class="ot">&lt;-</span> <span class="fu">replicate</span>(B, {</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>      bootstrap_sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(data, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>      lambda_b <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(bootstrap_sample)</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>      lambda_b</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 计算偏差和标准误差</span></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>    bias <span class="ot">&lt;-</span> <span class="fu">mean</span>(bootstrap_estimates) <span class="sc">-</span> lambda_hat</span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>    std_error <span class="ot">&lt;-</span> <span class="fu">sd</span>(bootstrap_estimates)</span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>    biases[j] <span class="ot">&lt;-</span> bias</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>    standard_errors[j] <span class="ot">&lt;-</span> std_error</span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>  mean_bias_results[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(biases)</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>  standard_error_results[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(standard_errors)</span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算理论值</span></span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>theoretical_biases <span class="ot">&lt;-</span> true_lambda <span class="sc">/</span> (sample_sizes <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a>theoretical_standard_errors <span class="ot">&lt;-</span> true_lambda <span class="sc">*</span> <span class="fu">sqrt</span>(sample_sizes) <span class="sc">/</span> ((sample_sizes <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">sqrt</span>(sample_sizes <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建一个数据框以存储结果</span></span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a>results_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sample_Size =</span> sample_sizes,</span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">Simulated_Bias =</span> mean_bias_results,</span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a>  <span class="at">Theoretical_Bias =</span> theoretical_biases,</span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">Simulated_Standard_Error =</span> standard_error_results,</span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">Theoretical_Standard_Error =</span> theoretical_standard_errors</span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-56"><a href="#cb42-56" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_df)</span></code></pre></div>
<pre><code>##   Sample_Size Simulated_Bias Theoretical_Bias Simulated_Standard_Error
## 1           5     0.15133710        0.5000000                0.6628546
## 2          10     0.05448212        0.2222222                0.2040772
## 3          20     0.02478109        0.1052632                0.1228265
##   Theoretical_Standard_Error
## 1                  0.6454972
## 2                  0.2484520
## 3                  0.1109571</code></pre>
</div>
<div id="question3" class="section level3">
<h3>question3</h3>
<p>利用boot.ci函数计算Bootstrap置信区间</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;boot&#39;是用R版本4.1.3 来建造的</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(law)  <span class="co"># 将数据附加到工作环境中</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 自定义函数，用于计算每个Bootstrap样本的相关性统计量和方差估计</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>cor.stat <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">NROW</span>(x)) {</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>(x[i, <span class="dv">1</span>], x[i, <span class="dv">2</span>])  <span class="co"># 计算相关性统计量</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 自定义函数，用于计算相关性统计量的方差估计</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>cor.stat2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">NROW</span>(x)) {</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 在每个Bootstrap样本上执行自定义函数 cor.stat</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>  o <span class="ot">&lt;-</span> <span class="fu">boot</span>(x[i, ], cor.stat, <span class="at">R =</span> <span class="dv">25</span>)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(i)  <span class="co"># 样本大小</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 返回相关性统计量和方差估计</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(o<span class="sc">$</span>t0, <span class="fu">var</span>(o<span class="sc">$</span>t) <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用boot函数执行Bootstrap分析</span></span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">boot</span>(law, <span class="at">statistic =</span> cor.stat2, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 利用boot.ci函数计算Bootstrap置信区间，使用&quot;stud&quot;类型，方差默认在返回的Bootstrap对象的第二个位置</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(b, <span class="at">type =</span> <span class="st">&quot;stud&quot;</span>)</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = b, type = &quot;stud&quot;)
## 
## Intervals : 
## Level    Studentized     
## 95%   (-0.3789,  1.0749 )  
## Calculations and Intervals on Original Scale</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(law)</span></code></pre></div>
</div>
</div>
<div id="homework-5" class="section level2">
<h2>homework 5</h2>
<div id="section-4" class="section level3">
<h3>7.5</h3>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures <span class="math inline">\(\frac{1}{\lambda}\)</span> by the standard normal, basic, percentile and BCa methods. Compare the intervals and explain why they may differ.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(aircondit)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> aircondit[<span class="dv">1</span>]</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 定义一个函数meant，用于计算Bootstrap样本的均值</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>mean.boot <span class="ot">&lt;-</span> <span class="cf">function</span>(x, i) <span class="fu">return</span>(<span class="fu">mean</span>(<span class="fu">as.matrix</span>(x[i, ])))</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 运行Bootstrap方法，R参数指定Bootstrap采样的次数</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">boot</span>(data, <span class="at">statistic =</span> mean.boot, <span class="at">R =</span> <span class="dv">2000</span>)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap估计结果</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = data, statistic = mean.boot, R = 2000)
## 
## 
## Bootstrap Statistics :
##     original    bias    std. error
## t1* 108.0833 0.2974167    36.91566</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算不同类型的Bootstrap置信区间，这里包括&quot;norm&quot;、&quot;perc&quot;、&quot;basic&quot;和&quot;bca&quot;</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(result, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = result, type = c(&quot;norm&quot;, &quot;perc&quot;, &quot;basic&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 35.4, 180.1 )   ( 26.6, 168.8 )  
## 
## Level     Percentile            BCa          
## 95%   ( 47.3, 189.6 )   ( 58.3, 226.9 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(aircondit)</span></code></pre></div>
<p>由于样本不是近似正态分布的，因此正态和百分位区间估计结果不一样。另，由于样本量太小，CLT无法在这里给出一个很好的近似值。BCa区间是一种百分位数类型的区间，但它对偏度和偏差都进行了调整。</p>
</div>
<div id="section-5" class="section level3">
<h3>7.8</h3>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(scor)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> scor</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建一个空的数值向量theta.jack，用于存储Jackknife估计的结果</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算数据集的特征值（eigenvalues）</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>eigenvalues <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(data))<span class="sc">$</span>values</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算全样本数据的估计值theta.hat</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> eigenvalues[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(eigenvalues)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 开始进行Jackknife估计的循环，逐一排除每个样本点</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 计算删除一个观测后的数据集的特征值</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>  eigenvalues <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(data[<span class="sc">-</span>i, ]))<span class="sc">$</span>values</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 计算Jackknife估计的结果，并将其存储在theta.jack向量中</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>  theta.jack[i] <span class="ot">&lt;-</span> eigenvalues[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(eigenvalues)</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算Jackknife估计的偏差（bias.jack）</span></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>bias.jack <span class="ot">&lt;-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(theta.jack) <span class="sc">-</span> theta.hat)</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算Jackknife估计的标准误差（se.jack）</span></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n <span class="sc">*</span> <span class="fu">sum</span>((theta.jack <span class="sc">-</span> <span class="fu">mean</span>(theta.jack))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a><span class="co"># 估计结果：估计值(theta.hat)，偏差(bias.jack)，和标准误差(se.jack)</span></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;theta hat:&quot;</span>, theta.hat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st"> bias:&quot;</span>, bias.jack, <span class="st">&quot;</span><span class="sc">\n</span><span class="st"> se:&quot;</span>, se.jack)</span></code></pre></div>
<pre><code>## theta hat: 0.619115 
##  bias: 0.001069139 
##  se: 0.04955231</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(scor)</span></code></pre></div>
</div>
<div id="section-6" class="section level3">
<h3>7.11</h3>
<p>Leave-one-out (n-fold) cross validation was used to select the best fitting model for the ironslag data. Use leave-two-out cross validation to compare the models.</p>
<p>仿照课本例7.18，使用”leave-two-out”交叉验证来比较模型1-4</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;DAAG&#39;是用R版本4.1.3 来建造的</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">choose</span>(n, <span class="dv">2</span>))</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="co"># fit models on leave-one-out samples</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>)) <span class="cf">for</span> (j <span class="cf">in</span> (i <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">c</span>(i, j)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>e1[t] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>e2[t] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat2)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>e3[t] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat3)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>logyhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[k])</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4)</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>e4[t] <span class="ot">&lt;-</span> <span class="fu">sum</span>((magnetic[k] <span class="sc">-</span> yhat4)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> t <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1), <span class="fu">mean</span>(e2), <span class="fu">mean</span>(e3), <span class="fu">mean</span>(e4))</span></code></pre></div>
<pre><code>## [1] 39.14455 35.74037 36.90983 40.93436</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(ironslag)</span></code></pre></div>
<p>根据预测误差标准，模型2（二次模型）最适合该数据。</p>
</div>
</div>
<div id="homework-6" class="section level2">
<h2>homework 6</h2>
<div id="ex-8.1" class="section level3">
<h3>Ex 8.1</h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))  <span class="co"># x 包含 &quot;soybean&quot; 饲料类型的体重数据</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))  <span class="co"># y 包含 &quot;linseed&quot; 饲料类型的体重数据</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 初始化参数</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span>  <span class="co"># 模拟次数</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)  <span class="co"># 样本 x 的大小</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)  <span class="co"># 样本 y 的大小</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)  <span class="co"># 将两个样本合并为一个样本</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> n <span class="sc">+</span> m  <span class="co"># 合并后样本的大小</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> Fn <span class="ot">&lt;-</span> Gm <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)  </span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算原始样本的统计量</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>  Fn[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>((z[i] <span class="sc">&lt;=</span> x))  <span class="co"># 计算 Fn</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>  Gm[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>((z[i] <span class="sc">&lt;=</span> y))  <span class="co"># 计算 Gm</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>C0 <span class="ot">&lt;-</span> ((n <span class="sc">*</span> m) <span class="sc">/</span> N) <span class="sc">*</span> <span class="fu">sum</span>((Fn <span class="sc">-</span> Gm)<span class="sc">^</span><span class="dv">2</span>)  <span class="co"># 计算原始样本的统计量</span></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 执行 R 次模拟</span></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R, {</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(N, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)  <span class="co"># 随机抽取样本 x 中的数据点</span></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> z[k]  <span class="co"># 根据抽取的索引构建新的 x1</span></span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k]  <span class="co"># 剩余的数据构成 y1</span></span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>    Fn[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>((z[i] <span class="sc">&lt;=</span> x1))  <span class="co"># 计算 Fn</span></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>    Gm[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>((z[i] <span class="sc">&lt;=</span> y1))  <span class="co"># 计算 Gm</span></span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>  ((n <span class="sc">*</span> m) <span class="sc">/</span> N) <span class="sc">*</span> <span class="fu">sum</span>((Fn <span class="sc">-</span> Gm)<span class="sc">^</span><span class="dv">2</span>)  <span class="co"># 计算模拟样本的统计量</span></span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出原始样本的统计量和 p-value</span></span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;statistic&quot;</span>, C0, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## statistic 4.228022</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;p.value&quot;</span>, <span class="fu">mean</span>(<span class="fu">c</span>(C0, C) <span class="sc">&gt;=</span> C0))  <span class="co"># 计算 p-value</span></span></code></pre></div>
<pre><code>## p.value 0.362</code></pre>
<p>可以看到，大豆和亚麻籽饲料的CvM检验的p值不显著。因此不认为两者分布之间存在差异。</p>
</div>
<div id="ex-8.3" class="section level3">
<h3>Ex 8.3</h3>
<p>根据6.4节,下面的函数“maxout”计算了每一个样本相对于另一个样本范围的端点数目的最大值.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>maxout <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx,outy)))</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>maxout_revised <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">R =</span> <span class="dv">999</span>) {</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)  <span class="co"># 获取第一个样本的大小</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)  <span class="co"># 合并两个样本的数据</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> n<span class="sc">+</span>m  <span class="co"># 合并后的总样本大小</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  M0 <span class="ot">&lt;-</span> <span class="fu">maxout</span>(x, y)  <span class="co"># 计算原始数据的统计量</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 使用 replicate 函数执行 R 次模拟</span></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>  M <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R, {</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">sample</span>(N, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)  <span class="co"># 随机抽取索引，保持原始样本大小</span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> z[k]  <span class="co"># 基于抽取的索引构建新的 x1 样本</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>    y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k]  <span class="co"># 剩余的数据构成新的 y1 样本</span></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">maxout</span>(x1, y1)  <span class="co"># 计算新样本的统计量</span></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 计算 p-value，表示原始数据的统计量在模拟中的分布情况</span></span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>  p.value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(M0, M) <span class="sc">&gt;=</span> M0)</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 返回估计值和 p-value</span></span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">estimate =</span> M0, <span class="at">p.value =</span> p.value))</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>对方差相同与不相同两种情况进行检验</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 方差相同</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="fu">maxout_revised</span>(x, y)</span></code></pre></div>
<pre><code>## $estimate
## [1] 3
## 
## $p.value
## [1] 0.657</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 方差不同</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="fu">maxout_revised</span>(x, y)</span></code></pre></div>
<pre><code>## $estimate
## [1] 25
## 
## $p.value
## [1] 0.002</code></pre>
</div>
</div>
<div id="homework-7" class="section level2">
<h2>homework 7</h2>
<div id="ex-1" class="section level3">
<h3>Ex 1</h3>
<p>(1)根据chap 7 example 1 ,计算<span class="math inline">\(\alpha\)</span>的代码如下：</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 定义函数计算 alpha</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="cf">function</span>(N, b1, b2, b3, f0) {</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 生成符合分布的随机样本</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N, <span class="dv">1</span>)       <span class="co"># X1 服从泊松分布</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N)           <span class="co"># X2 服从指数分布</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  x3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N, <span class="dv">1</span>, <span class="fl">0.5</span>)  <span class="co"># X3 服从二项分布</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 定义函数 g</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="cf">function</span>(alpha) {</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>    tmp <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>alpha <span class="sc">-</span> b1 <span class="sc">*</span> x1 <span class="sc">-</span> b2 <span class="sc">*</span> x2 <span class="sc">-</span> b3 <span class="sc">*</span> x3)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> tmp)</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(p) <span class="sc">-</span> f0</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 使用 uniroot 求解方程</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(g, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">10</span>))</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 返回解的 alpha</span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="at">alpha =</span> solution<span class="sc">$</span>root)</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>(2)调用上述函数</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">6</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>f0 <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">01</span>,.<span class="dv">001</span>,.<span class="dv">0001</span>)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="fu">alpha</span>(N,b1,b2,b3,f0[<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] -3.169736</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">alpha</span>(N,b1,b2,b3,f0[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] -6.068682</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">alpha</span>(N,b1,b2,b3,f0[<span class="dv">3</span>])</span></code></pre></div>
<pre><code>## [1] -8.725542</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">alpha</span>(N,b1,b2,b3,f0[<span class="dv">4</span>])</span></code></pre></div>
<pre><code>## [1] -11.28013</code></pre>
<p>(3)绘制-log(f0) vs alpha图</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#生成 f0 的序列</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>f0 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.0001</span>, <span class="fl">0.99</span>, <span class="at">length =</span> <span class="dv">100</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 初始化存储 alphas 的向量</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>alphas <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(f0))</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 循环计算 alpha</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(f0)) {</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>  alphas[i] <span class="ot">&lt;-</span> <span class="fu">alpha</span>(N, b1, b2, b3, f0[i])</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制图形</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="sc">-</span><span class="fu">log</span>(f0), alphas, <span class="at">xlab =</span> <span class="st">&quot;-log(f0)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;alpha&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Plot of -log(f0) vs alpha&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="ex-9.4" class="section level3">
<h3>Ex 9.4</h3>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Metropolis采样函数</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>rw.Metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 初始化向量存储采样结果</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>    x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 初始化接受次数</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 生成均匀分布的随机数</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>    u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Metropolis采样过程</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 从正态分布生成候选样本</span></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>        y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 判断是否接受候选样本</span></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> <span class="fu">exp</span>(<span class="fu">abs</span>(x[i<span class="dv">-1</span>]) <span class="sc">-</span> <span class="fu">abs</span>(y))) {</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>            x[i] <span class="ot">&lt;-</span> y  </span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>            k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>        } <span class="cf">else</span> {</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>            x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 返回结果</span></span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x =</span> x, <span class="at">k =</span> k))</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">5</span>, <span class="fl">2.5</span>,  <span class="dv">16</span>)</span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-30"><a href="#cb81-30" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb81-31"><a href="#cb81-31" aria-hidden="true" tabindex="-1"></a>rw1 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb81-32"><a href="#cb81-32" aria-hidden="true" tabindex="-1"></a>rw2 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb81-33"><a href="#cb81-33" aria-hidden="true" tabindex="-1"></a>rw3 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb81-34"><a href="#cb81-34" aria-hidden="true" tabindex="-1"></a>rw4 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb81-35"><a href="#cb81-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-36"><a href="#cb81-36" aria-hidden="true" tabindex="-1"></a><span class="co">#计算每个链条的接受率</span></span>
<span id="cb81-37"><a href="#cb81-37" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">sigma=</span>sigma,<span class="at">accept.rate=</span><span class="fu">c</span>(rw1<span class="sc">$</span>k, rw2<span class="sc">$</span>k, rw3<span class="sc">$</span>k, rw4<span class="sc">$</span>k)<span class="sc">/</span>N)</span></code></pre></div>
<pre><code>##   sigma accept.rate
## 1  0.05      0.9790
## 2  0.50      0.8300
## 3  2.50      0.4820
## 4 16.00      0.0915</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>rline <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fu">qexp</span>(.<span class="dv">975</span>),<span class="fu">qexp</span>(.<span class="dv">975</span>))</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>rw <span class="ot">&lt;-</span> <span class="fu">cbind</span>(rw1<span class="sc">$</span>x, rw2<span class="sc">$</span>x, rw3<span class="sc">$</span>x,rw4<span class="sc">$</span>x)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">plot</span>(rw[, j], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="fu">bquote</span>(sigma <span class="sc">==</span> .(<span class="fu">round</span>(sigma[j], <span class="dv">3</span>))), <span class="at">ylab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">ylim =</span> <span class="fu">range</span>(rw[, j]))</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h =</span> rline)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>可以看出，只有第三条链的拒绝率在[0.15,0.5]内，由图可以看出: 当标准差<span class="math inline">\(\sigma= 0.05\)</span>时,增量太小几乎每个候选点都被接受链在2000次选代后还没有收敛。当<span class="math inline">\(\sigma=2.5\)</span>时，链很快收敛。而当<span class="math inline">\(\sigma=16\)</span> 时,接受的概率太小,使得大部分候选点被拒绝，链虽然收敛了，但是效率很低(需要更多的运行时间才能得到指定数目的随机数)。因此收敛性相对最好的链是第三条链。</p>
<p>以前500次为预烧期，比较Q-Q图和直方图如下</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 生成概率点</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ppoints</span>(<span class="dv">200</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 生成Laplace分布的分位数</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">qexp</span>(p, <span class="dv">1</span>)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fu">rev</span>(y), y)</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 从每个Metropolis采样结果中提取一部分样本</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> rw1<span class="sc">$</span>x[<span class="dv">501</span><span class="sc">:</span>N]</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> rw2<span class="sc">$</span>x[<span class="dv">501</span><span class="sc">:</span>N]</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> rw3<span class="sc">$</span>x[<span class="dv">501</span><span class="sc">:</span>N]</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>y4 <span class="ot">&lt;-</span> rw4<span class="sc">$</span>x[<span class="dv">501</span><span class="sc">:</span>N]</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制Q-Q图</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>Q1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(y1, p)</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(z, Q1, <span class="at">main =</span> <span class="fu">bquote</span>(sigma <span class="sc">==</span> .(<span class="fu">round</span>(sigma[<span class="dv">1</span>], <span class="dv">3</span>))), <span class="at">xlab =</span> <span class="st">&quot;Laplace Quantiles&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Sample Quantiles&quot;</span>)</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>Q2 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(y2, p)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(z, Q2, <span class="at">main =</span> <span class="fu">bquote</span>(sigma <span class="sc">==</span> .(<span class="fu">round</span>(sigma[<span class="dv">2</span>], <span class="dv">3</span>))), <span class="at">xlab =</span> <span class="st">&quot;Laplace Quantiles&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Sample Quantiles&quot;</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>Q3 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(y3, p)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(z, Q3, <span class="at">main =</span> <span class="fu">bquote</span>(sigma <span class="sc">==</span> .(<span class="fu">round</span>(sigma[<span class="dv">3</span>], <span class="dv">3</span>))), <span class="at">xlab =</span> <span class="st">&quot;Laplace Quantiles&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Sample Quantiles&quot;</span>)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>Q4 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(y4, p)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqplot</span>(z, Q4, <span class="at">main =</span> <span class="fu">bquote</span>(sigma <span class="sc">==</span> .(<span class="fu">round</span>(sigma[<span class="dv">4</span>], <span class="dv">3</span>))), <span class="at">xlab =</span> <span class="st">&quot;Laplace Quantiles&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Sample Quantiles&quot;</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>从QQ图来看，<span class="math inline">\(\sigma=2.5\)</span>时样本分位数和理论分位数差别最小，综上，第三条链收敛效果最好。</p>
</div>
<div id="ex-9.7" class="section level3">
<h3>Ex 9.7</h3>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 初始化常量和参数</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span>    <span class="co"># 链的长度</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># 预烧期长度</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)  </span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span>   <span class="co"># 相关性</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> rho<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> sigma1</span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> rho<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> sigma2</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 生成链</span></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1, mu2)  <span class="co"># 初始化</span></span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> X[i <span class="sc">-</span> <span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a>  m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1 <span class="sc">/</span> sigma2</span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2 <span class="sc">/</span> sigma1</span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a>  X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb88-22"><a href="#cb88-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb88-23"><a href="#cb88-23" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb88-24"><a href="#cb88-24" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb88-25"><a href="#cb88-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-26"><a href="#cb88-26" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制图形</span></span>
<span id="cb88-27"><a href="#cb88-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x[, <span class="dv">1</span>], <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">col =</span> <span class="dv">1</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">xlab =</span> <span class="st">&#39;Index&#39;</span>, <span class="at">ylab =</span> <span class="st">&#39;Random numbers&#39;</span>)</span>
<span id="cb88-28"><a href="#cb88-28" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x[, <span class="dv">2</span>], <span class="at">col =</span> <span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb88-29"><a href="#cb88-29" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;bottomright&#39;</span>, <span class="fu">c</span>(<span class="fu">expression</span>(X), <span class="fu">expression</span>(Y)), <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> x[, <span class="dv">1</span>]</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> x[, <span class="dv">2</span>]</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Y ~ X)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.60570 -0.29159 -0.00268  0.28844  1.59143 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.004208   0.006873   0.612     0.54    
## X           0.896242   0.006961 128.749   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4342 on 3998 degrees of freedom
## Multiple R-squared:  0.8057, Adjusted R-squared:  0.8056 
## F-statistic: 1.658e+04 on 1 and 3998 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>可以看到,数据被线性模型拟合得很好。下面通过正态性和常值方差来检查模型残差。</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --> 从Q-Q图可以看出和散点图可看出，残差是正态的，残差方差恒定，不是异方差的。</p>
</div>
<div id="ex-9.10" class="section level3">
<h3>Ex 9.10</h3>
<p>Example9.8中的函数Gelman.Rubin如下，它计算了诊断统计量</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="co"># for chain in i-th row of X</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(r.hat)</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 定义概率密度函数</span></span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, sigma) {</span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (x <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="dv">0</span>)</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stopifnot</span>(sigma <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>((x<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb92-22"><a href="#cb92-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb92-23"><a href="#cb92-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-24"><a href="#cb92-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Metropolis-Hastings链生成函数</span></span>
<span id="cb92-25"><a href="#cb92-25" aria-hidden="true" tabindex="-1"></a>Rayleigh.MH.chain <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, m, x0) {</span>
<span id="cb92-26"><a href="#cb92-26" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb92-27"><a href="#cb92-27" aria-hidden="true" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb92-28"><a href="#cb92-28" aria-hidden="true" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb92-29"><a href="#cb92-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb92-30"><a href="#cb92-30" aria-hidden="true" tabindex="-1"></a>    xt <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb92-31"><a href="#cb92-31" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df =</span> xt)</span>
<span id="cb92-32"><a href="#cb92-32" aria-hidden="true" tabindex="-1"></a>    num <span class="ot">&lt;-</span> <span class="fu">f</span>(y, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(xt, <span class="at">df =</span> y)</span>
<span id="cb92-33"><a href="#cb92-33" aria-hidden="true" tabindex="-1"></a>    den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(y, <span class="at">df =</span> xt)</span>
<span id="cb92-34"><a href="#cb92-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den)</span>
<span id="cb92-35"><a href="#cb92-35" aria-hidden="true" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb92-36"><a href="#cb92-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb92-37"><a href="#cb92-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb92-38"><a href="#cb92-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb92-39"><a href="#cb92-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb92-40"><a href="#cb92-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-41"><a href="#cb92-41" aria-hidden="true" tabindex="-1"></a><span class="co"># 设定参数</span></span>
<span id="cb92-42"><a href="#cb92-42" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb92-43"><a href="#cb92-43" aria-hidden="true" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">/</span>sigma, sigma<span class="sc">^</span><span class="dv">2</span>, sigma<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb92-44"><a href="#cb92-44" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb92-45"><a href="#cb92-45" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb92-46"><a href="#cb92-46" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> k, <span class="at">ncol =</span> m)</span>
<span id="cb92-47"><a href="#cb92-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-48"><a href="#cb92-48" aria-hidden="true" tabindex="-1"></a><span class="co"># 生成Metropolis-Hastings链</span></span>
<span id="cb92-49"><a href="#cb92-49" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) X[i, ] <span class="ot">&lt;-</span> <span class="fu">Rayleigh.MH.chain</span>(sigma, m, x0[i])</span>
<span id="cb92-50"><a href="#cb92-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-51"><a href="#cb92-51" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算路径的累积均值</span></span>
<span id="cb92-52"><a href="#cb92-52" aria-hidden="true" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb92-53"><a href="#cb92-53" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi)) psi[i, ] <span class="ot">&lt;-</span> psi[i, ] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb92-54"><a href="#cb92-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-55"><a href="#cb92-55" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算 Gelman-Rubin 统计量</span></span>
<span id="cb92-56"><a href="#cb92-56" aria-hidden="true" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi)</span>
<span id="cb92-57"><a href="#cb92-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-58"><a href="#cb92-58" aria-hidden="true" tabindex="-1"></a><span class="co"># 打印结果</span></span>
<span id="cb92-59"><a href="#cb92-59" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Gelman-Rubin 统计量：&quot;</span>, rhat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Gelman-Rubin 统计量： 1.136212</code></pre>
<p>使用”coda”程序包通过Gelman-Rubin方法检验链条收敛性</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 导入 coda 包</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 将每个链转换为 coda::mcmc 对象</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(X[<span class="dv">1</span>, ])</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(X[<span class="dv">2</span>, ])</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>X3 <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(X[<span class="dv">3</span>, ])</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>X4 <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(X[<span class="dv">4</span>, ])</span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 将所有链组成 mcmc.list</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(X1, X2, X3, X4)</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 打印 Gelman-Rubin 统计量</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">gelman.diag</span>(Y))</span></code></pre></div>
<pre><code>## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]       1.01       1.02</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制 Gelman-Rubin 统计量的图形</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gelman.plot</span>(Y, <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="homework-8" class="section level2">
<h2>homework 8</h2>
<div id="question-1" class="section level3">
<h3>question 1</h3>
<p>直接用观测数据的MLE</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 区间观测数据</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">8</span>, <span class="dv">27</span>, <span class="dv">13</span>, <span class="dv">16</span>, <span class="dv">0</span>, <span class="dv">23</span>, <span class="dv">10</span>, <span class="dv">24</span>, <span class="dv">2</span>,</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>                 <span class="dv">12</span>, <span class="dv">9</span>, <span class="dv">28</span>, <span class="dv">14</span>, <span class="dv">17</span>, <span class="dv">1</span>, <span class="dv">24</span>, <span class="dv">11</span>, <span class="dv">25</span>, <span class="dv">3</span>), <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">FALSE</span>)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>logL <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda) {</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  log_likelihood<span class="ot">&lt;-</span><span class="fu">sum</span>((data[,<span class="dv">2</span>]<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>data[,<span class="dv">2</span>])<span class="sc">-</span>data[,<span class="dv">1</span>]<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>data[,<span class="dv">1</span>]))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>data[,<span class="dv">1</span>])<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>data[,<span class="dv">2</span>])))</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(log_likelihood)</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(logL, <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>))</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Lambda 的 MLE 数值解为:&quot;</span>, <span class="fu">round</span>(solution<span class="sc">$</span>root,<span class="dv">4</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;Lambda 的 MLE 数值解为: 0.072&quot;</code></pre>
<p>EM算法</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># E-M 算法</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>E_step <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda){</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(lambda<span class="sc">*</span>(data[,<span class="dv">1</span>]<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>data[,<span class="dv">1</span>])<span class="sc">-</span>data[,<span class="dv">2</span>]<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>data[,<span class="dv">2</span>]))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>data[,<span class="dv">1</span>])<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>data[,<span class="dv">2</span>])))</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>M_step <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda){</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  n<span class="sc">*</span>lambda<span class="sc">/</span>(<span class="fu">E_step</span>(lambda)<span class="sc">+</span>n)</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#初始值</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>epsilon<span class="ot">&lt;-</span><span class="fl">1e-6</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>criteria<span class="ot">&lt;-</span><span class="fl">1e10</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (criteria<span class="sc">&gt;</span>epsilon <span class="sc">&amp;&amp;</span> iter <span class="sc">&lt;</span> <span class="dv">1000</span>) {</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>  lambda_new <span class="ot">&lt;-</span> <span class="fu">M_step</span>(lambda)</span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>  iter <span class="ot">&lt;-</span> iter<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>  criteria<span class="ot">&lt;-</span><span class="fu">abs</span>(lambda_new<span class="sc">-</span>lambda)</span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> lambda_new</span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;E-M算法得到的Lambda的MLE解为:&quot;</span>, <span class="fu">round</span>(lambda_new,<span class="dv">3</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;E-M算法得到的Lambda的MLE解为: 0.072&quot;</code></pre>
</div>
<div id="question211.8" class="section level3">
<h3>question2:11.8</h3>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>solve.game <span class="ot">&lt;-</span> <span class="cf">function</span>(A) {</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  min.A <span class="ot">&lt;-</span> <span class="fu">min</span>(A)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> A <span class="sc">-</span> min.A</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  max.A <span class="ot">&lt;-</span> <span class="fu">max</span>(A)</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> A<span class="sc">/</span><span class="fu">max</span>(A)</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(A)</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>  it <span class="ot">&lt;-</span> n<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="dv">1</span>)</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>  A1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">cbind</span>(<span class="fu">t</span>(A), <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, n))</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>  A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, m), <span class="dv">0</span>)))</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>  b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>  sx <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a =</span> a, <span class="at">A1 =</span> A1, <span class="at">b1 =</span> b1, <span class="at">A3 =</span> A3, <span class="at">b3 =</span> b3,</span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">maxi =</span> <span class="cn">TRUE</span>, <span class="at">n.iter =</span> it)</span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="dv">1</span>)</span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>  A1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A, <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, m))</span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)</span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>  A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n), <span class="dv">0</span>)))</span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a>  b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a>  sy <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a =</span> a, <span class="at">A1 =</span> A1, <span class="at">b1 =</span> b1, <span class="at">A3 =</span> A3, <span class="at">b3 =</span> b3,</span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">maxi =</span> <span class="cn">FALSE</span>, <span class="at">n.iter =</span> it)</span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a>  soln <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">A =</span> A <span class="sc">*</span> max.A <span class="sc">+</span> min.A, <span class="at">x =</span> sx<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>m],</span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a>               <span class="at">y =</span> sy<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>n], <span class="at">v =</span> sx<span class="sc">$</span>soln[m <span class="sc">+</span> <span class="dv">1</span>] <span class="sc">*</span> max.A <span class="sc">+</span> min.A)</span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a>  soln</span>
<span id="cb101-26"><a href="#cb101-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb101-27"><a href="#cb101-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-28"><a href="#cb101-28" aria-hidden="true" tabindex="-1"></a><span class="co"># 示例输入数据</span></span>
<span id="cb101-29"><a href="#cb101-29" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb101-30"><a href="#cb101-30" aria-hidden="true" tabindex="-1"></a>              <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb101-31"><a href="#cb101-31" aria-hidden="true" tabindex="-1"></a>              <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">4</span>,</span>
<span id="cb101-32"><a href="#cb101-32" aria-hidden="true" tabindex="-1"></a>              <span class="sc">-</span><span class="dv">3</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>,</span>
<span id="cb101-33"><a href="#cb101-33" aria-hidden="true" tabindex="-1"></a>              <span class="dv">3</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>,</span>
<span id="cb101-34"><a href="#cb101-34" aria-hidden="true" tabindex="-1"></a>              <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>,</span>
<span id="cb101-35"><a href="#cb101-35" aria-hidden="true" tabindex="-1"></a>              <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb101-36"><a href="#cb101-36" aria-hidden="true" tabindex="-1"></a>              <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="sc">-</span><span class="dv">6</span>, <span class="sc">-</span><span class="dv">6</span>, <span class="dv">0</span>), <span class="dv">9</span>, <span class="dv">9</span>)</span>
<span id="cb101-37"><a href="#cb101-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-38"><a href="#cb101-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-39"><a href="#cb101-39" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot) </span>
<span id="cb101-40"><a href="#cb101-40" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> A <span class="sc">+</span> <span class="dv">2</span></span>
<span id="cb101-41"><a href="#cb101-41" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">solve.game</span>(B)</span>
<span id="cb101-42"><a href="#cb101-42" aria-hidden="true" tabindex="-1"></a>s<span class="sc">$</span>v  <span class="co"># 输出解决方案的值</span></span></code></pre></div>
<pre><code>## x10 
##   2</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cbind</span>(s<span class="sc">$</span>x, s<span class="sc">$</span>y), <span class="dv">7</span>)</span></code></pre></div>
<pre><code>##         [,1]      [,2]
## x1 0.0000000 0.0000000
## x2 0.0000000 0.0000000
## x3 0.4098361 0.4098361
## x4 0.0000000 0.0000000
## x5 0.3278689 0.3278689
## x6 0.0000000 0.0000000
## x7 0.2622951 0.2622951
## x8 0.0000000 0.0000000
## x9 0.0000000 0.0000000</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(s<span class="sc">$</span>x <span class="sc">*</span> <span class="dv">61</span>, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>## x1 x2 x3 x4 x5 x6 x7 x8 x9 
##  0  0 25  0 20  0 16  0  0</code></pre>
<p>游戏B的极值点为原游戏A的其中一个极值点(11.15)。</p>
</div>
</div>
<div id="homework-9" class="section level2">
<h2>homework 9</h2>
<div id="exercise-4-pages-19-advanced-in-r" class="section level3">
<h3>2.1.3 Exercise 4 (Pages 19 Advanced in R)</h3>
<p>Why do you need to use unlist() to convert a list to an atomic vector? Why doesn’t as.vector() work?</p>
<p>Answer：unlist()函数可以将一个列表转换为一个原子向量，因为它会将列表中的所有元素展开并组合成一个单一的向量。而as.vector()函数在这种情况下并不会产生相同的效果。因为as.vector()函数在处理列表时通常只是确认对象是否已经是向量，如果对象是列表，它通常只是返回原对象，不会展开列表中的元素。</p>
</div>
<div id="exercise-1-2-pages-26-advanced-in-r" class="section level3">
<h3>2.3.1 Exercise 1, 2 (Pages 26 Advanced in R)</h3>
<ol style="list-style-type: decimal">
<li>What does dim() return when applied to a vector?</li>
</ol>
<p>Answer：当应用于一个向量时，dim()函数会返回NULL，因为向量是一维的，没有维度信息。</p>
<ol start="2" style="list-style-type: decimal">
<li>If is.matrix(x) is TRUE, what will is.array(x) return?</li>
</ol>
<p>Answer：如果 is.matrix(x) 返回 TRUE，那么 is.array(x) 也会返回 TRUE。因为在 R 中，矩阵是具有两个维度的特定类型的数组，所以如果某物被识别为矩阵，它也自然符合数组的条件。</p>
</div>
<div id="exercise-2-3-pages-30-advanced-in-r" class="section level3">
<h3>2.4.5 Exercise 2, 3 (Pages 30 Advanced in R)</h3>
<ol start="2" style="list-style-type: decimal">
<li>What does as.matrix() do when applied to a data frame with columns of different types?</li>
</ol>
<p>Answer：当应用于具有不同类型列的数据框时，as.matrix()将尝试将数据框转换为矩阵。由于矩阵要求所有元素类型相同，因此在转换时，as.matrix() 会尝试将数据框中的所有列转换为同一种类型。通常情况下，这意味着将所有列转换为具有最灵活数据类型的统一类型，例如将字符型数据转换为因子或将字符型数据转换为数值型数据。</p>
<ol start="3" style="list-style-type: decimal">
<li>Can you have a data frame with 0 rows? What about 0 columns?</li>
</ol>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 可以</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x=</span><span class="fl">0.1</span>,<span class="at">y=</span><span class="fl">0.2</span>)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>a[<span class="cn">FALSE</span>,]</span></code></pre></div>
<pre><code>## [1] x y
## &lt;0 行&gt; (或0-长度的row.names)</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>a[,<span class="cn">FALSE</span>]</span></code></pre></div>
<pre><code>## data frame with 0 columns and 1 row</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>a[<span class="cn">FALSE</span>,<span class="cn">FALSE</span>]</span></code></pre></div>
<pre><code>## data frame with 0 columns and 0 rows</code></pre>
</div>
<div id="exercises-2-page-204-advanced-r" class="section level3">
<h3>Exercises 2 (page 204, Advanced R)</h3>
<p>The function below scales a vector so it falls in the range [0,1]. How would you apply it to every column of a data frame?How would you apply it to every numeric column in a data frame?</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>(x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>使用 apply() 函数来对数据框的每一列应用这个函数。对于所有的数值列，先使用 lapply() 筛选出数值列，然后再利用 apply() 应用 scale01() 函数。</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 先构造两个dataframe </span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 数值数据框</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="dv">6</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;D&quot;</span>,<span class="st">&quot;E&quot;</span>)</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x=</span>x,<span class="at">y=</span>y)</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 混合数据框</span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>mix.df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">x=</span>x,<span class="at">y=</span>y,<span class="at">z=</span>z)</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 对于数据框的所有列应用函数</span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(df, <span class="dv">2</span>, scale01)</span></code></pre></div>
<pre><code>##         x    y
## [1,] 0.00 0.00
## [2,] 0.25 0.25
## [3,] 0.50 0.50
## [4,] 0.75 0.75
## [5,] 1.00 1.00</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 对于数据框的数值列应用函数</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">lapply</span>(mix.df, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="fu">is.numeric</span>(x)) <span class="fu">scale01</span>(x) <span class="cf">else</span> x))</span></code></pre></div>
<pre><code>##      x    y z
## 1 0.00 0.00 A
## 2 0.25 0.25 B
## 3 0.50 0.50 C
## 4 0.75 0.75 D
## 5 1.00 1.00 E</code></pre>
</div>
<div id="exercises-1-page-213-advanced-r" class="section level3">
<h3>Exercises 1 (page 213, Advanced R)</h3>
<ol style="list-style-type: decimal">
<li>Use vapply() to:</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li><p>Compute the standard deviation of every column in a numeric data frame.</p></li>
<li><p>Compute the standard deviation of every numeric column in a mixed data frame. (Hint: you’ll need to use vapply() twice.)</p></li>
<li><p>计算数值数据框中每一列的标准差：</p></li>
</ol>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 仍然利用Exercises 2 (page 204, Advanced R)构造的数据框</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(df, sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##        x        y 
## 1.581139 1.581139</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>计算混合数据框中的每个数值列的标准差：</li>
</ol>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 仍然利用Exercises 2 (page 204, Advanced R)构造的数据框</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vapply</span>(mix.df[<span class="fu">vapply</span>(mix.df, is.numeric, <span class="fu">logical</span>(<span class="dv">1</span>))],sd, <span class="fu">numeric</span>(<span class="dv">1</span>))</span></code></pre></div>
<pre><code>##        x        y 
## 1.581139 1.581139</code></pre>
</div>
<div id="question-2" class="section level3">
<h3>question 2</h3>
<p>Consider Exercise 9.8 (pages 278, Statistical Computing with R). (Hint: Refer to the first example of Case studies section)</p>
<p>• Write an R function.</p>
<p>• Write an Rcpp function.</p>
<p>• Compare the computation time of the two functions with the function “microbenchmark”.</p>
<p>r code</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>gibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(N,a,b,n) {</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> N, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> y <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x<span class="sc">+</span>a, n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>    mat[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>  mat</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Rcpp code</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>NumericMatrix <span class="fu">gibbsC</span>(int N,  int a, int b, int n) {</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  NumericMatrix <span class="fu">mat</span>(N, <span class="dv">2</span>);</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  double x <span class="ot">=</span> <span class="dv">0</span>, y <span class="ot">=</span> <span class="dv">0</span>;</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(int <span class="at">i =</span> <span class="dv">0</span>; i <span class="sc">&lt;</span> N; i<span class="sc">++</span>) {</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y)[<span class="dv">0</span>];</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">=</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x<span class="sc">+</span>a, n<span class="sc">-</span>x<span class="sc">+</span>b)[<span class="dv">0</span>];</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mat</span>(i, <span class="dv">0</span>) <span class="ot">=</span> x;</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mat</span>(i, <span class="dv">1</span>) <span class="ot">=</span> y;</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(mat);</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Rcpp&#39;是用R版本4.1.3 来建造的</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;microbenchmark&#39;是用R版本4.1.3 来建造的</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(SA23204168)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">gibbsR=</span><span class="fu">gibbsR</span>(<span class="dv">100</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">10</span>),<span class="at">gibbsC=</span><span class="fu">gibbsC</span>(<span class="dv">100</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">10</span>))</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(ts)[,c(1,3,5,6)]</span></span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
